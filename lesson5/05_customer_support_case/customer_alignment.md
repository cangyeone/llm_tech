# 教程：客服场景对齐案例分析

## 学习目标
- 构建含有优选/拒绝回答的客服场景偏好数据集。
- 使用预训练模型生成回复并根据礼貌性、覆盖度进行评分。
- 将结果导出为表格，支持业务部门回顾与优化。

## 背景原理
客服对齐关注礼貌、同理心与问题解决能力。本案例通过人工模板打分：
$$
\text{score} = 0.6 \times \text{coverage} + 0.4 \times \text{politeness},
$$
其中 `coverage` 检查是否包含感谢/道歉等关键措辞，`politeness` 评估礼貌表达。

## 代码结构解析
- `CUSTOMER_PROMPTS`：预置两组客服问题及理想回答，可扩展为更多案例。
- `build_case_dataset`：使用 `train_test_split` 将案例划分为训练/评估集。
- `score_responses`：生成客服回答并根据规则打分，记录得分与理想答案。
- `export_results`：将结果保存为 CSV，便于课程展示或业务复盘。

## 实践步骤
1. 根据企业场景扩充 `CUSTOMER_PROMPTS`，增加投诉、售后、退款等类型。
2. 调整评分规则，例如加入响应时长、情绪稳定性等指标。
3. 运行脚本并查看 `outputs/customer_case/customer_alignment.csv` 中的得分，分析模型差距。
4. 将得分较低的案例用于偏好数据或奖励模型训练，形成闭环优化。

## 拓展问题
- 如何引入人工标注的细粒度标签，例如情绪管理、问题解决效率？
- 可否结合语音/文本多模态数据，为电话客服场景提供更真实的模拟？
- 在实际部署中，如何将该评分逻辑嵌入到实时监控系统中？
