# 教程：垂直领域摘要微调案例

## 学习目标
- 构建垂直行业（金融合规）摘要数据集并进行指令微调。
- 熟悉 Seq2Seq 模型的输入输出格式及 `Trainer` 配置。
- 理解如何在训练后生成案例摘要，验证模型效果。

## 背景原理
垂直领域微调强调领域知识与术语一致性。通过小规模高质量数据，可以让预训练模型学习行业特定表达。Seq2Seq 模型以条件概率建模：
$$
\max_{\theta} \prod_{t=1}^{T} p_{\theta}(y_t \mid y_{<t}, x),
$$
其中 $x$ 为输入报告，$y_t$ 为目标摘要 token。

## 代码结构解析
- `DomainConfig`：定义基础模型与输出目录。
- `build_dataset`：构造包含 30 条摘要示例的数据集，可替换为真实报告。
- `tokenize`：分别对输入与输出进行分词，设置不同的最大长度。
- `TrainingArguments`：配置 batch 大小、学习率、评估/保存步数等。
- 推理示例：使用训练后的模型生成新的报告摘要。

## 实践步骤
1. 将 `build_dataset` 替换为真实行业数据，确保隐私脱敏。
2. 根据任务复杂度调整 `num_train_epochs` 与 `learning_rate`。
3. 使用 `predict_with_generate=True` 获取评估阶段生成结果，便于 BLEU/ROUGE 计算。
4. 训练完成后，通过示例 prompt 验证模型能否输出结构化摘要。

## 深入问题
- 如何引入领域词表或适配器，进一步提升专业术语掌握度？
- 若要支持多语言摘要，需要如何扩充数据与模型配置？
- 可以结合 RAG 将最新法规信息检索出来再输入模型，以提升准确性吗？
